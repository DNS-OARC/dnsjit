addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    - sourceline: 'ppa:dns-oarc/ck'
    update: true
    packages:
    - gcc-5
    - libluajit-5.1-dev
    - libpcap-dev
    - luajit
    - liblmdb-dev
    - libck-dev
    - libgnutls-dev
language: c
compiler:
  - clang
  - gcc
install:
  - if [ "$CC" = "gcc" ]; then export CC="gcc-5"; fi
  - ./autogen.sh
script:
  - ./configure --enable-warn-all
  - make dist
  - tar zxvf *.tar.gz
  - cd dnsjit-[0-9]*
  - mkdir build
  - cd build
  - ../configure --enable-warn-all
  - make
  - make test
